<!DOCTYPE html>
<html>
<head>
  <title>Biomass App</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <h2>Biomass Calculation</h2>

  <div class="div-1">

    <div class="row">
      <div class="col-md-1">
          <nav class="navbar navbar-light">
              <a class="navbar-brand" href="/" style="color: white">
                  <span class="mb-0 h6"></span>&nbsp;Biomass&nbsp;</a></span>
                  
              </a>
          </nav>
      </div>
  <div class="col-md-9">
  </div>


  <label for="heightInput">Height:</label>
  <input type="number" id="heightInput" step="0.01" value="0" />
  <label for="DBH">DBH:</label>
  <input type="number" id="DBH" step="0.01" value="0" />
  <button onclick="loadCSV()">Load Data</button>

  <br><br>
  <select id="dropdown"></select>
  <p id="result"></p>

  <script>
  function loadCSV() {
    const height = parseFloat(document.getElementById("heightInput").value);
    const dbh = parseFloat(document.getElementById("dbhInput").value);

     if (!(height === 0 && dbh > 0)) {
        document.getElementById("result").innerText = "Wrong parameters: height must be 0 and DBH must be > 0.";
        document.getElementById("dropdown").innerHTML = "";
        return;
      }
    const aCsvUrl = "https://raw.githubusercontent.com/hamidzar/hamidzar.github.io/main/biomass/AGBnoHeight.csv"; // Replace with your actual CSV URL
    const bCsvUrl = "https://raw.githubusercontent.com/hamidzar/hamidzar.github.io/main/biomass/AGBwithheights.csv";
    const csvUrl = height === 0 ? aCsvUrl : bCsvUrl;
 
   


      d3.csv(csvUrl).then(data => {
        const dropdown = document.getElementById("dropdown");
        dropdown.innerHTML = ""; // Clear previous options

         

        data.forEach(row => {
          const option = document.createElement("option");

         
          if (height === 0 && dbh > 0) {
          option.value = row.estimatebwood1 * DBH;
          option.text = `${row.speciesx} (${row.estimatebwood1}%)`;
          dropdown.appendChild(option);

          } else if (height > 0 && dbh > 0) {
          option.value = row.estimatebwood1 * DBH;
          option.text = `${row.speciesx} (${row.estimatebwood1}%)`;
          dropdown.appendChild(option);
                    
          } else {      
        
            document.getElementById("result").innerText = "Condition not met: height must not be 0 and DBH must be greater than 0.";
            document.getElementById("dropdown").innerHTML = "";
            return;
          }

         

        });

        dropdown.addEventListener("change", function () {
          const selectedestimatebwood1 = +this.value;
          const result = selectedestimatebwood1;
          document.getElementById("result").innerText = `Result: ${result}`;
        });

        dropdown.dispatchEvent(new Event("change")); // Trigger initial calculation
      });
  }    
  </script>
</body>
</html>

